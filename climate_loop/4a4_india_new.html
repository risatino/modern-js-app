<script>
    $(function() {
        Highcharts.setOptions({
            lang: {
                numericSymbols: null,
                thousandsSep: ','
            },
        });
        var setFontsize = '20px';
        var setFontsizeLegend = '22px';
        var topMargin = 20;
        var axisMargin = 20;
        var rightMargin = 200;
        var bgColor = '#252830';
        
//Chart Data
       var us4a4_electric_17vs16 = [{
            name: 'Fuel',
            color: '#DF5656',
            data: [-2.50, -3.30, -24.00, -7.70, 0, -0.10, 0, 0, 0, 0, 0, -4.80, 0, -2.90, -1.50],
        }, {
            name: 'Change',
            color: '#168DD9',
            data: [0, 0, 0, 0, 10.60, 0, 12.00, 13.40, 12.00, 46.90, 5.70, 0, 0.90, 2.90, 1.50]
        }];
       
//Make Chart
        $("#us4a4_electric_17vs16").highcharts({
            chart: {
                marginRight: rightMargin,
                marginTop: topMargin,
                backgroundColor: bgColor,
                type: "bar",
                alignTicks: !1
            },
            legend: {
                layout: "horizontal",
                itemStyle: {
                    fontSize: setFontsizeLegend
                }
            },
            credits: !1,
            exporting: {
                enabled: !1
            },
            title: !1,
            xAxis: [{
                title: {
                categories: ['Coal', 'Petroleum Liquids', 'Petroleum Coke', 'Natural Gas', 'Other Gas', 'Nuclear', 'Hydroelectric', 'Renewable Sources', '...Wind', '...Solar', '...Wood', '...Other Biomass', '...Geothermal', 'Hydroelectric Pumped', 'All Energy Sources'],
                labels: {
                    step: 1,
                    style: {
                        fontSize: setFontsize
                    }
                }
            }
            }],
            yAxis: [{
                title: {
                    text: null,
                    style: {
                        fontSize: setFontsize
                    },
                    margin: axisMargin
                },
                labels: {
                    formatter: function() {
                        return Highcharts.numberFormat(this.value, 0) + '%'
                    },
                    style: {
                        fontSize: setFontsize
                    }
                }
            }],
            tooltip: {
                shared: !0,
                useHTML: !0,
                headerFormat: "<h5>{point.key}</h5>",
                pointFormat: '<span style="color:{series.color}">‚óè</span> {series.name}: <b>{point.y}</b><br>',
                style: {
                    fontSize: setFontsize
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        style: {
                            fontSize: setFontsize
                        }
                    },
                    style: {
                        color: Highcharts.theme && Highcharts.theme.contrastTextColor || "black",
                        fontSize: setFontsize
                    }
                },
                series: {
                    stacking: 'normal',
                    lineWidth: 4,
                    marker: {
                        fillColor: bgColor,
                        radius: 6,
                        lineWidth: 4,
                        lineColor: null,
                        states: {
                            hover: {
                                enabled: !0,
                                radiusPlus: 4
                            }
                        }
                    },
                    states: {
                        hover: {
                            enabled: !0,
                            lineWidthPlus: 2
                        }
                    }
                }
            },
            series: us4a4_electric_17vs16
        });
        
        // reflow charts in hidden modals
        $('.modal').on('shown.bs.modal', function() {
            $(".chart").each(function() {
                var chart = $(this).highcharts();
                chart.reflow();
            });
        });
        $('').on('shown.bs.modal', function() {
            $(".chart").each(function() {
                var chart = $(this).highcharts();
                chart.reflow();
            });
        });
    });
</script>

<!--new data----------------------------------------------------------------------------------------------------------------------------------->
<script>

//Start of 4.a.4.
//Chart Data    
var categories = ['Coal', 'Petroleum Liquids', 'Petroleum Coke', 'Natural Gas', 'Other Gas', 'Nuclear', 'Hydroelectric', 'Renewable Sources', '...Wind', '...Solar', '...Wood', '...Other Biomass', '...Geothermal', 'Hydroelectric Pumped', 'All Energy Sources'];
var us4a4_electric_17vs16 = [{
        name: 'Deficit (-)',
        color: '#DF5656',
        data: [-2.50, -3.30, -24.00, -7.70, 0, -0.10, 0, 0, 0, 0, 0, -4.80, 0, -2.90, -1.50]
    }, {
        name: 'Change (+)',
        color: '#168DD9',
        data: [0, 0, 0, 0, 10.60, 0, 12.00, 13.40, 12.00, 46.90, 5.70, 0, 0.90, 2.90, 1.50]
    }];
//Make Data
$("#us4a4_electric_17vs16").highcharts({
    chart: {
        backgroundColor: bgColor,
        type: 'bar'
    },
    legend: {
            layout: "horizontal",
                itemStyle: {
                    fontSize: setFontsizeLegend
                }
            },
            credits: !1,
            exporting: {
                enabled: !1
            },
    title: {
        text: null
    },
    xAxis: [{
        title: {text:'Fuel', style: {fontSize: setFontsize}},
        categories: categories,
        labels: {
            step: 1,
        style: {
                fontSize: setFontsize
            }  
      }      
    }],
    yAxis: {
        title: {
            text: null
        },
        min: -30,
        max: 50,
        intervals: 10,
        allowDecimals: false,
        labels: {
            formatter: function () {
                return Math.abs(this.value) + '%';
            },
            style: {
                fontSize: setFontsize
            }
        }
    },

    plotOptions: {
        series: {
            stacking: 'normal',
            pointWidth: 25
        }
    },

    tooltip: {
        style: {
                fontSize: setFontsize
        },
        formatter: function () {
            return '<b>' + this.series.name + ': ' + this.point.category + '</b><br/>' + Highcharts.numberFormat(Math.abs(this.point.y), 2) + '%';
        }
    },

    series: us4a4_electric_17vs16
});
//End of 4.a.4.

</script>

<!--old code-->

<div class="modal fade wide" id="modal-us-diverging-chart" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>
        <h2 class="modal-title" class="ss-standard ss-alert">4.a.4. Where Americans Got Their Electricity, 2017 vs. 2016</h2>
      </div>
      <div class="modal-body">
        <div class="container">
          <div class="row">
            <div class="col-sm-7">   
             <div class="atlas-chart" data-id="B1j49N4_z" data-width="640" data-height="449"><img src="https://www.theatlas.com/i/atlas_B1j49N4_z.png" style="max-width: 100%;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-----------------------------------------------------------------------------------------------------------------------------------------NEW script-->
<script>
//Start of 4.a.4.
//Chart Data    
var categories=["Coal","Petroleum Liquids","Petroleum Coke","Natural Gas","Other Gas","Nuclear","Hydroelectric","Renewable Sources","...Wind","...Solar","...Wood","...Other Biomass","...Geothermal","Hydroelectric Pumped","All Energy Sources"],us4a4_electric_17vs16=[{name:"Deficit (-) %",color:"#DF5656",data:[-2.5,-3.3,-24,-7.7,0,-.1,0,0,0,0,0,-4.8,0,-2.9,-1.5]},{name:"Change (+) %",color:"#168DD9",data:[0,0,0,0,10.6,0,12,13.4,12,46.9,5.7,0,.9,2.9,1.5]}];
//Make Data
$("#us4a4_electric_17vs16").highcharts({chart:{backgroundColor:bgColor,type:"bar"},legend:{layout:"horizontal",itemStyle:{fontSize:setFontsizeLegend}},credits:!1,exporting:{enabled:!1},title:{text:null},xAxis:[{title:{text:"Fuel",style:{fontSize:setFontsize}},categories:categories,labels:{step:1,style:{fontSize:setFontsize}}}],yAxis:{title:{text:null},min:-30,max:50,intervals:10,allowDecimals:!1,labels:{formatter:function(){return Math.abs(this.value)+"%"},style:{fontSize:setFontsize}}},plotOptions:{series:{stacking:"normal",pointWidth:25}},tooltip:{style:{fontSize:setFontsize},formatter:function(){return"<b>"+this.series.name+": "+this.point.category+"</b><br/>"+Highcharts.numberFormat(Math.abs(this.point.y),2)+"%"}},series:us4a4_electric_17vs16});
//End of 4.a.4.
</script>